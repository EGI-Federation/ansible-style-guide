---
language: python
python:
  - '2.7'
  - '3.6'
sudo: required
services:
  - docker
env:
  global:
    - MD_IGNORE="R1"
    - TEST_ROLE_PATH="ansible-role-test/"
    - GITHUB_REPO=$TRAVIS_REPO_SLUG
    - RUBOCOP_OPTS="--fail-level=error"
    - secure: Bhh4BStFxJ0H7QHAyKz+7LbijYREBp8EGS4WRO5Mto53ebPqdpP+GxCJjeU7zMMc+3QDL98Cz/FibVNJaxXnNbiXKbq8zMMpDZHWVC5h4JvOdOs9g7fYB6BvKn6FZd+9qq+S3RThE8SoYCKxY577sphGzAhDeOsecbwq5Q1MPl2PVRg7IKZvdTTqlcvK4qUIPnA/2ALeulmsSUhAGwX5CUxwuZqrLWQeN3v8UdW9TbS9c6BzjTB3WmxD0tUT4ZLLDH0FwVm6C578p3p7WLoAGpfh0V8Pu4yR/qeE1PTJKmq2Ix9lcc/4R/68rmSlSnFiY/kfqzc/33M7zeiKnE/+M2zxkig8auYpHHKuw9fTsnTl7+o3BFlMXK9qZTisLCx6x4G6AxNtF/3/YyTnof+SP17b7PWHDatFqV7TRJy5j9LBlxKUqmrEYty/E188h5ohu3+dmFQI9qZwqlstcvzchEwzlWjBFpZtXmfOg+nKtmNneOpS7q1SBPWn+6dtNQ/mrCk5l+9AKKoO/aOeBSF7zWmeGCmgJWjVLk994MZNg9/RcLimHXfhtZUXZCMGyTCP2MXi49ieo4iglxbqgrBKWkTrL618k2f89drP0zCSd5IyQI0uBYrCDR85lURV/hLXpzf5N05YVIiMPCglxxCQiFvgaQauSpkiDbS2UT8kMvQ=
addons:
  apt:
    packages:
      - ruby-full
before_install:
install:
  - pip install -r requirements.txt
  - bundle install
before_script:
  - for file in `find . -maxdepth 2 -name "*.md"` ;  do markdownlint --ignore $MD_IGNORE $file ; done
script:
  - ansible-galaxy init -f --role-skeleton=egi-galaxy-template $TEST_ROLE_PATH
  - inspec supermarket exec brucellino/ansible-fashion-police --controls=Travis Meta 'Ansible Skeleton Directories' 'Ansible YAML main files'
  - cd $TEST_ROLE_PATH
  - molecule init scenario -r $TEST_ROLE_PATH
  - molecule test
after_success:
after_failure:
before_deploy:
deploy:
after_deploy:
after_script:
notifications:
  slack:
    secure: S5s1uMaEu6FZjovKwBU43GKoZsdAFvUhvbnfGKfymSZxVNGNmPpWkpPiTeH5keo3lMEorU5KQgPKPwoXTIZnHv687kpW+KUIqfZw2Z2NVkrfJ8gZxj2oOqbCCXl+JHeJSziQ/siUDJriadfqt7tmXWLvlw19G+Na5mBevqFxtFpQ6HrCapEpOkarcmJbOONxlk8zVKcjCh06sZYtxdiRK67VAsoQWINnAmp1sFNjwoaSCF1ATayk76XGsObUmS3/ku51a5gyPzWmZzc0biXk+XGjeB2BRwur/uzQa2UQmlUBrhYLMzTDvUse2oR/i6ae2/vT90wBxMk/dY+OF5rO0v0i9sZMdl102F/CgAGlPPQ/aTXVI6pVnL+5D/X0OqaJ+CR4EhUVjXNbvdkg1wm7EZQbWpKP1P3Hf3YnzPTwllZCX/NNz/5vtJjjedm161EtKi0WgbcKt9UTmINCfGDAg/2vmVm3bBUqdrdGlX5VUszhlGxGobTAeTHyoLgY0+qjm6Gj8f/VTsoq+jIRhZ0Mh1c/eTH179RGCNhwhL3H7QEMarbFx+D1Lhh5MN5bNyJ8Q6Mt7GaRB57OHRpLSZSAgbR/HGkaKF8gyA6zxUh2yxsIRJw0KvX4PPSYJbcyR8fa96I1xcRFNwC1XmP4WzFu2ocGBERK+bHZSqkT2T7DSCw=
